{"ast":null,"code":"var _jsxFileName = \"/media/rajkjain/Fdrive/IIIT_SEM_FIRST/SSD/midlab/VidyaVichar-Classroom-Q-A-sticky-board/frontend/src/pages/ClassroomPage.js\",\n  _s = $RefreshSig$();\n// frontend/src/pages/ClassroomPage.js\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { useParams } from 'react-router-dom';\nimport { useSelector } from 'react-redux';\nimport axios from 'axios';\nimport { selectCurrentUser } from '../features/authSlice';\nimport QuestionForm from '../components/QuestionForm';\nimport QuestionCard from '../components/QuestionCard';\nimport FilterControls from '../components/FilterControls'; // <-- Import new component\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst ClassroomPage = () => {\n  _s();\n  const {\n    classId\n  } = useParams();\n  const user = useSelector(selectCurrentUser);\n  const [questions, setQuestions] = useState([]);\n  const [filter, setFilter] = useState(''); // <-- New state for filtering\n  const [error, setError] = useState('');\n  const [submissionMessage, setSubmissionMessage] = useState('');\n  const fetchQuestions = useCallback(async () => {\n    if (user.role !== 'teacher') return;\n    try {\n      const config = {\n        headers: {\n          Authorization: `Bearer ${user.token}`\n        },\n        params: {\n          status: filter || undefined\n        } // <-- Add filter to request\n      };\n      const {\n        data\n      } = await axios.get(`http://localhost:5000/api/questions/${classId}`, config);\n      setQuestions(data);\n    } catch (err) {\n      setError('Failed to fetch questions. You may not have permission.');\n    }\n  }, [classId, user.token, user.role, filter]); // <-- Add filter to dependency array\n\n  useEffect(() => {\n    fetchQuestions();\n  }, [fetchQuestions]);\n  const handleClearAll = async () => {\n    if (window.confirm(\"Are you sure you want to delete all questions in this class? This cannot be undone.\")) {\n      try {\n        const config = {\n          headers: {\n            Authorization: `Bearer ${user.token}`\n          }\n        };\n        await axios.delete(`http://localhost:5000/api/questions/${classId}/clear`, config);\n        fetchQuestions(); // Refresh the list\n      } catch (err) {\n        alert('Failed to clear questions.');\n      }\n    }\n  };\n\n  // --- (handleQuestionSubmit and handleStatusChange functions remain unchanged) ---\n\n  // in frontend/src/pages/ClassroomPage.js\n\n  const handleQuestionSubmit = async text => {\n    setSubmissionMessage(''); // Clear previous success messages\n    setError(''); // Clear previous error messages\n\n    try {\n      const config = {\n        headers: {\n          Authorization: `Bearer ${user.token}`\n        }\n      };\n      await axios.post(`http://localhost:5000/api/questions/${classId}`, {\n        text\n      }, config);\n      setSubmissionMessage('Your question has been submitted successfully!');\n      if (user.role === 'teacher') {\n        fetchQuestions();\n      }\n    } catch (err) {\n      var _err$response, _err$response$data;\n      // Set the specific error message from the backend response\n      setError(((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.message) || 'Failed to post question.');\n    }\n  };\n  const handleStatusChange = async (questionId, status) => {\n    try {\n      const config = {\n        headers: {\n          Authorization: `Bearer ${user.token}`\n        }\n      };\n      await axios.patch(`http://localhost:5000/api/questions/${questionId}/status`, {\n        status\n      }, config);\n      fetchQuestions();\n    } catch (err) {\n      alert('Failed to update status.');\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"classroom-grid\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"classroom-main\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"Classroom Q&A\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 9\n      }, this), error && /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"error-message\",\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 19\n      }, this), user.role === 'student' && /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(QuestionForm, {\n          onSubmit: handleQuestionSubmit\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 87,\n          columnNumber: 13\n        }, this), submissionMessage && /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"success-message\",\n          children: submissionMessage\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 88,\n          columnNumber: 35\n        }, this)]\n      }, void 0, true), user.role === 'teacher' && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"question-board\",\n        children: questions.length > 0 ? questions.map(q => /*#__PURE__*/_jsxDEV(QuestionCard, {\n          question: q,\n          user: user,\n          onStatusChange: handleStatusChange\n        }, q._id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 95,\n          columnNumber: 17\n        }, this)) : /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"No questions match the current filter.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 103,\n          columnNumber: 15\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 7\n    }, this), user.role === 'teacher' && /*#__PURE__*/_jsxDEV(\"aside\", {\n      className: \"classroom-sidebar\",\n      children: /*#__PURE__*/_jsxDEV(FilterControls, {\n        setFilter: setFilter,\n        onClear: handleClearAll\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 81,\n    columnNumber: 5\n  }, this);\n};\n_s(ClassroomPage, \"bx6hDfAldnPn6Smla17gdKVR2QA=\", false, function () {\n  return [useParams, useSelector];\n});\n_c = ClassroomPage;\nexport default ClassroomPage;\nvar _c;\n$RefreshReg$(_c, \"ClassroomPage\");","map":{"version":3,"names":["React","useState","useEffect","useCallback","useParams","useSelector","axios","selectCurrentUser","QuestionForm","QuestionCard","FilterControls","jsxDEV","_jsxDEV","Fragment","_Fragment","ClassroomPage","_s","classId","user","questions","setQuestions","filter","setFilter","error","setError","submissionMessage","setSubmissionMessage","fetchQuestions","role","config","headers","Authorization","token","params","status","undefined","data","get","err","handleClearAll","window","confirm","delete","alert","handleQuestionSubmit","text","post","_err$response","_err$response$data","response","message","handleStatusChange","questionId","patch","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onSubmit","length","map","q","question","onStatusChange","_id","onClear","_c","$RefreshReg$"],"sources":["/media/rajkjain/Fdrive/IIIT_SEM_FIRST/SSD/midlab/VidyaVichar-Classroom-Q-A-sticky-board/frontend/src/pages/ClassroomPage.js"],"sourcesContent":["// frontend/src/pages/ClassroomPage.js\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { useParams } from 'react-router-dom';\nimport { useSelector } from 'react-redux';\nimport axios from 'axios';\nimport { selectCurrentUser } from '../features/authSlice';\nimport QuestionForm from '../components/QuestionForm';\nimport QuestionCard from '../components/QuestionCard';\nimport FilterControls from '../components/FilterControls'; // <-- Import new component\n\nconst ClassroomPage = () => {\n  const { classId } = useParams();\n  const user = useSelector(selectCurrentUser);\n  const [questions, setQuestions] = useState([]);\n  const [filter, setFilter] = useState(''); // <-- New state for filtering\n  const [error, setError] = useState('');\n  const [submissionMessage, setSubmissionMessage] = useState('');\n\n  const fetchQuestions = useCallback(async () => {\n    if (user.role !== 'teacher') return;\n    try {\n      const config = {\n        headers: { Authorization: `Bearer ${user.token}` },\n        params: { status: filter || undefined }, // <-- Add filter to request\n      };\n      const { data } = await axios.get(`http://localhost:5000/api/questions/${classId}`, config);\n      setQuestions(data);\n    } catch (err) {\n      setError('Failed to fetch questions. You may not have permission.');\n    }\n  }, [classId, user.token, user.role, filter]); // <-- Add filter to dependency array\n\n  useEffect(() => {\n    fetchQuestions();\n  }, [fetchQuestions]);\n\n  const handleClearAll = async () => {\n    if (window.confirm(\"Are you sure you want to delete all questions in this class? This cannot be undone.\")) {\n      try {\n        const config = { headers: { Authorization: `Bearer ${user.token}` } };\n        await axios.delete(`http://localhost:5000/api/questions/${classId}/clear`, config);\n        fetchQuestions(); // Refresh the list\n      } catch (err) {\n        alert('Failed to clear questions.');\n      }\n    }\n  };\n\n  // --- (handleQuestionSubmit and handleStatusChange functions remain unchanged) ---\n\n  // in frontend/src/pages/ClassroomPage.js\n\n  const handleQuestionSubmit = async (text) => {\n    setSubmissionMessage(''); // Clear previous success messages\n    setError('');             // Clear previous error messages\n\n    try {\n      const config = { headers: { Authorization: `Bearer ${user.token}` } };\n      await axios.post(`http://localhost:5000/api/questions/${classId}`, { text }, config);\n      setSubmissionMessage('Your question has been submitted successfully!');\n      if (user.role === 'teacher') {\n        fetchQuestions();\n      }\n    } catch (err) {\n      // Set the specific error message from the backend response\n      setError(err.response?.data?.message || 'Failed to post question.');\n    }\n  };\n\n  const handleStatusChange = async (questionId, status) => {\n    try {\n      const config = { headers: { Authorization: `Bearer ${user.token}` } };\n      await axios.patch(`http://localhost:5000/api/questions/${questionId}/status`, { status }, config);\n      fetchQuestions();\n    } catch (err) {\n      alert('Failed to update status.');\n    }\n  };\n\n  return (\n    <div className=\"classroom-grid\">\n      <div className=\"classroom-main\">\n        <h2>Classroom Q&A</h2>\n        {error && <p className=\"error-message\">{error}</p>}\n        {user.role === 'student' && (\n          <>\n            <QuestionForm onSubmit={handleQuestionSubmit} />\n            {submissionMessage && <p className=\"success-message\">{submissionMessage}</p>}\n          </>\n        )}\n        {user.role === 'teacher' && (\n          <div className=\"question-board\">\n            {questions.length > 0 ? (\n              questions.map((q) => (\n                <QuestionCard\n                  key={q._id}\n                  question={q}\n                  user={user}\n                  onStatusChange={handleStatusChange}\n                />\n              ))\n            ) : (\n              <p>No questions match the current filter.</p>\n            )}\n          </div>\n        )}\n      </div>\n      {user.role === 'teacher' && (\n        <aside className=\"classroom-sidebar\">\n          <FilterControls setFilter={setFilter} onClear={handleClearAll} />\n        </aside>\n      )}\n    </div>\n    \n  );\n};\n\nexport default ClassroomPage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}